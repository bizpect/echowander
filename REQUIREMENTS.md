
# 📱 Echowander – 기능 요구사항 명세서 (MVP)

## 1. 앱 개요
- 전 세계 사용자들이 **익명 메시지를 릴레이 방식으로 전달**
- 메시지는 여러 사용자를 거쳐 **일정 조건 충족 시 원작성자에게 반환**
- 실시간 채팅 ❌ / 비동기 메시지 릴레이 ⭕
- 목적: **호기심·재미·감정 공유 기반 소셜 경험**

---

## 2. 사용자 & 인증

### 2.1 사용자 식별
- 모든 사용자는 내부적으로 **고유 식별자**를 가진다
- 실명/개인정보 수집 ❌
- 차단/신고/제재를 위한 식별은 필수

### 2.2 사용자 기본 정보
- 알림 수신 여부
- 차단 목록

---

## 3. 온보딩 & 정책 동의 (필수)
- 최초 실행 시:
  - 커뮤니티 가이드라인
  - 콘텐츠 정책
  - 신고/차단 안내
- **명시적 동의 필수**
- 동의 전까지 핵심 기능 접근 불가

---

## 4. 메시지(여정, Journey) 기능

### 4.1 메시지 작성
- 사용자는 **텍스트 메시지**를 작성할 수 있다
- 메시지에 **이미지 첨부 가능 (최대 3장)**
- 이미지 규칙:
  - 이미지 첨부는 선택 사항
  - 허용 포맷/용량은 정책으로 제한 가능
- 작성 제한:
  - 글자 수 제한
  - URL / 연락처 패턴 차단
- 작성 후 상태:
  - `CREATED`
  - 자동 필터링 수행

---

### 4.2 관리자/자동 필터링
- 모든 메시지는 **자동 필터링**을 거친다
- 결과 상태:
  - `OK` → 릴레이 가능
  - `HELD` → 관리자 검토 후 릴레이
  - `REMOVED` → 폐기
- 완벽 차단 ❌ → **사후 조치 구조**

---

### 4.3 메시지 릴레이 (핵심 기능)
- 메시지는 **언어 기반**으로 랜덤 사용자에게 전달
- 수신자는 다음 중 선택 가능:
  - 응답 작성
  - 패스
  - 신고
- 제약:
  - 동일 사용자는 동일 메시지에 **1회만 참여**
  - 차단 관계는 매칭 제외

---

### 4.4 릴레이 진행 상태 표시
- 원작성자는:
  - 릴레이 진행 중에는 **결과 열람 불가**
  - “어느 나라의 사용자가 응답 중인지” 정도의 **비식별 정보만 확인 가능**

---

### 4.5 릴레이 종료 조건
- 정책으로 관리:
  - 응답 횟수 도달
  - 또는 시간 만료
- 종료 시 상태:
  - `COMPLETED`

---

## 5. 결과 반환
- 릴레이 종료 시:
  - 모든 응답을 **한 번에 묶어서**
  - **원작성자에게만 공개**
- 응답자에게는 결과 노출 ❌

---

## 6. 신고 & 차단 (심사 핵심)

### 6.1 신고 기능
- 모든 메시지/응답에 신고 가능
- 신고 사유는 **코드값 기반**
- 신고 누적 시:
  - 메시지 즉시 숨김
  - 릴레이 중단
  - 관리자 검토 상태로 전환

### 6.2 차단 기능
- 사용자 차단 가능
- 차단된 사용자:
  - 서로 메시지 매칭 ❌
- 차단 목록 관리 화면 제공

---

## 7. 푸시 알림 & 딥링크

### 7.1 푸시 알림
- 주요 이벤트:
  - 메시지 결과 도착 (필수)
  - 새 릴레이 참여 가능 메시지 (선택)
- 광고/홍보성 푸시 ❌

### 7.2 딥링크 대응
- 푸시 클릭 시 모든 상태에서 정상 동작:
  - 앱 미설치 / 설치 직후
  - 종료 / 백그라운드
  - 온보딩 전/후
- 표준 딥링크 타입:
  - `results/{journeyId}`
  - `inbox`
  - `onboarding`
  - `safety`

---

## 8. 광고(수익 모델, MVP)
- AdMob 사용
- 광고 노출 원칙:
  - 결과 열람 전 **Rewarded Ad**
  - 작성/응답 중 광고 ❌
- 광고 실패 시 UX 정의 필요

---

## 9. 데이터 접근 & 보안
- DB 직접 접근 ❌
- **Supabase RPC 함수로만 접근**
- RLS 정책 우회 ❌
- 모든 상태/구분값은 **common_codes 기반**

---

## 10. 운영 & 품질 요구사항
- 환경 분리:
  - DEV / PROD
- 에러 / 로그 / 크래시 리포팅 필수
- 임시 해결 금지
  - 원인 분석 후 근본 해결만 허용

---

## 11. MVP 화면 구성
- 온보딩 / 가이드라인
- 메시지 작성
- 인박스(수신/응답)
- 결과 화면
- 설정(알림, 차단, 정책)
